{
  "$defs": {
    "upstream": {
      "title": "Upstream value",
      "description": "Propagated from upstream component.",
      "type": "string",
      "pattern": "^\\{\\{ [a-z]([a-z0-9-]{0,61}[a-z0-9])?(.[a-zA-Z_][a-zA-Z_0-9]*(\\[(0|[1-9][0-9]*)\\])?)+ \\}\\}$"
    },
    "instill_types": {
      "text": {
        "type": "string",
        "format": "text"
      },
      "image": {
        "type": "string",
        "format": "image",
        "contentEncoding": "base64"
      },
      "audio": {
        "type": "string",
        "format": "audio",
        "contentEncoding": "base64"
      },
      "video": {
        "type": "string",
        "format": "video",
        "contentEncoding": "base64"
      },
      "bounding_box": {
        "type": "object",
        "format": "bounding_box",
        "description": "The detected bounding box in (left, top, width, height) format",
        "additionalProperties": false,
        "required": ["left", "top", "width", "height"],
        "properties": {
          "left": {
            "description": "Bounding box left x-axis value",
            "type": "number"
          },
          "top": {
            "description": "Bounding box top y-axis value",
            "type": "number"
          },
          "width": {
            "description": "Bounding box width value",
            "type": "number"
          },
          "height": {
            "description": "Bounding box height value",
            "type": "number"
          }
        }
      },
      "classification": {
        "type": "object",
        "format": "classification",
        "additionalProperties": false,
        "required": ["category", "score"],
        "properties": {
          "category": {
            "description": "The predicted category of the input",
            "type": "string"
          },
          "score": {
            "description": "The confidence score of the predicted category of the input",
            "type": "number"
          }
        }
      },
      "detection": {
        "type": "object",
        "format": "detection",
        "additionalProperties": false,
        "required": ["objects"],
        "properties": {
          "objects": {
            "description": "A list of detected objects",
            "type": "array",
            "items": {
              "type": "object",
              "additionalProperties": false,
              "required": ["bounding_box", "category", "score"],
              "properties": {
                "bounding_box": {
                  "$ref": "#/$defs/instill_types/bounding_box"
                },
                "category": {
                  "description": "The predicted category of the bounding box",
                  "type": "string"
                },
                "score": {
                  "description": "The confidence score of the predicted category of the bounding box",
                  "type": "number"
                }
              }
            }
          }
        }
      },
      "keypoint": {
        "type": "object",
        "format": "keypoint",
        "additionalProperties": false,
        "required": ["objects"],
        "properties": {
          "objects": {
            "description": "A list of keypoint objects, a keypoint object includes all the pre-defined keypoints of a detected object",
            "type": "array",
            "items": {
              "type": "object",
              "required": ["keypoints", "score", "bounding_box"],
              "properties": {
                "keypoints": {
                  "description": "A keypoint group is composed of a list of pre-defined keypoints of a detected object",
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": ["x", "y", "v"],
                    "properties": {
                      "x": {
                        "description": "x coordinate of the keypoint",
                        "type": "number"
                      },
                      "y": {
                        "description": "y coordinate of the keypoint",
                        "type": "number"
                      },
                      "v": {
                        "description": "visibility score of the keypoint",
                        "type": "number"
                      }
                    }
                  }
                },
                "score": {
                  "description": "The confidence score of the predicted object",
                  "type": "number"
                },
                "bounding_box": {
                  "$ref": "#/$defs/instill_types/bounding_box"
                }
              }
            }
          }
        }
      },
      "ocr": {
        "type": "object",
        "format": "ocr",
        "additionalProperties": false,
        "required": ["objects"],
        "properties": {
          "objects": {
            "description": "A list of detected bounding boxes",
            "type": "array",
            "items": {
              "type": "object",
              "required": ["boundingBox", "text", "score"],
              "properties": {
                "boundingBox": {
                  "$ref": "#/$defs/instill_types/bounding_box"
                },
                "text": {
                  "description": "Text string recognised per bounding box",
                  "type": "string"
                },
                "score": {
                  "description": "The confidence score of the predicted object",
                  "type": "number"
                }
              }
            }
          }
        }
      },
      "instance_segmentation": {
        "type": "object",
        "format": "instance_segmentation",
        "additionalProperties": false,
        "required": ["objects"],
        "properties": {
          "objects": {
            "description": "A list of detected instance bounding boxes",
            "type": "array",
            "items": {
              "type": "object",
              "required": ["rle", "boundingBox", "category", "score"],
              "properties": {
                "rle": {
                  "description": "Run Length Encoding (RLE) of instance mask within the bounding box",
                  "type": "string"
                },
                "boundingBox": {
                  "$ref": "#/$defs/instill_types/bounding_box"
                },
                "category": {
                  "description": "The predicted category of the bounding box",
                  "type": "string"
                },
                "score": {
                  "description": "The confidence score of the predicted instance object",
                  "type": "number"
                }
              }
            }
          }
        }
      },
      "semantic_segmentation": {
        "type": "object",
        "format": "semantic_segmentation",
        "additionalProperties": false,
        "required": ["stuffs"],
        "properties": {
          "stuffs": {
            "description": "A list of RLE binary masks",
            "type": "array",
            "items": {
              "type": "object",
              "required": ["rle", "category"],
              "properties": {
                "rle": {
                  "description": "Run Length Encoding (RLE) of each stuff mask within the image",
                  "type": "string"
                },
                "category": {
                  "description": "Category text string corresponding to each stuff mask",
                  "type": "string"
                }
              }
            }
          }
        }
      },
      "embedding": {
        "type": "array",
        "format": "embedding",
        "items": {
          "type": "number"
        }
      },
      "semi_structured": {
        "type": "object",
        "format": "semi_structured"
      },
      "metadata": {
        "type": "object",
        "format": "metadata"
      }
    }
  }
}
